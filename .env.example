# ============================================
# APPLICATION SETTINGS
# ============================================
NODE_ENV=development
PORT=3001
APP_NAME="Audit Core"
APP_URL=http://localhost:3001

# ============================================
# DATABASE (PostgreSQL)
# ============================================
# Usa DATABASE_URL (recomendado) o variables separadas DB_*
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/audit_db

# Alternativa con variables separadas (opcional):
# DB_HOST=localhost
# DB_PORT=5432
# DB_USERNAME=postgres
# DB_PASSWORD=postgres
# DB_DATABASE=audit_core_db

# ============================================
# LOGGING (Winston)
# ============================================
LOG_LEVEL=debug

# ============================================
# EMAIL (Ethereal para testing)
# ============================================
MAIL_HOST=smtp.ethereal.email
MAIL_PORT=587
MAIL_SECURE=false
MAIL_USER=
MAIL_PASSWORD=
MAIL_FROM=noreply@audit-core.com
MAIL_FROM_NAME="Audit Core"

# ============================================
# REDIS (Cache y Sesiones)
# ============================================
# Redis para blacklist de tokens y almacenamiento de refresh tokens
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# ============================================
# JWT (Autenticación)
# ============================================
# Access tokens: corta duración (15min) en Authorization header
# Refresh tokens: larga duración (7 días) en HTTP-only cookies
JWT_SECRET=your-secret-key-change-in-production
JWT_EXPIRES_IN=15m
JWT_REFRESH_SECRET=your-different-refresh-secret-change-in-production
JWT_REFRESH_EXPIRES_IN=7d

# ============================================
# RESET PASSWORD TOKENS
# ============================================
# Sistema híbrido (JWT + Redis) para máxima seguridad:
# - JWT contiene userId y tokenId (stateless, verificable sin DB)
# - Redis almacena tokenId con TTL (revocable, un solo uso)
# - Al validar se verifica firma JWT Y existencia en Redis
# Este enfoque es el estándar de la industria para procesos sensibles
RESET_PASSWORD_TOKEN_EXPIRES_IN=1h
RESET_PASSWORD_JWT_SECRET=your-reset-password-jwt-secret-change-in-production

# ============================================
# TWO FACTOR AUTHENTICATION (2FA)
# ============================================
# Sistema híbrido (JWT + Redis) siguiendo estándares OWASP:
# - Código numérico (6 dígitos) fácil de leer para el usuario
# - JWT permite verificación stateless del código
# - Redis garantiza un solo uso y revocación inmediata
# - TTL corto (5 minutos) para máxima seguridad
TWO_FACTOR_CODE_LENGTH=6
TWO_FACTOR_CODE_EXPIRES_IN=5m
TWO_FACTOR_JWT_SECRET=your-2fa-jwt-secret-change-in-production

# ============================================
# CORS
# ============================================
CORS_ORIGIN=*

# ============================================
# FILE UPLOADS
# ============================================
UPLOADS_DIR=./uploads
MAX_FILE_SIZE=10485760

# ============================================
# THROTTLING
# ============================================
THROTTLE_TTL=60
THROTTLE_LIMIT=10

# ============================================
# PAGINATION
# ============================================
DEFAULT_PAGE_SIZE=10
MAX_PAGE_SIZE=100

# ============================================
# SESSION / COOKIES
# ============================================
SESSION_SECRET=
SESSION_MAX_AGE=86400000

# ============================================
# SWAGGER
# ============================================
SWAGGER_ENABLED=true
SWAGGER_PATH=api

# ============================================
# SECURITY
# ============================================
BCRYPT_ROUNDS=10

# ============================================
# FRONTEND URLS
# ============================================
FRONTEND_URL=http://localhost:3000
FRONTEND_VERIFY_EMAIL_URL=http://localhost:3000/verify-email
FRONTEND_RESET_PASSWORD_URL=http://localhost:3000/reset-password

# ============================================
# TIMEZONE
# ============================================
TZ=America/La_Paz
